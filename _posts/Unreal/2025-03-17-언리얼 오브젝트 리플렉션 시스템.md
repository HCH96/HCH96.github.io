---
title: 언리얼 오브젝트 리플렉션
date: 2025-03-17 05:40:00 +09:00
categories: [Unreal, 언리얼 c++의 이해]
published: true
tags:
  [unreal, cpp]
---

## 언리얼 프로퍼티 시스템(리플렉션)

**리플렉션(Reflection)**은 프로그램이 실행시간에 자기 자신을 조사하는 기능이다. C#, Java에서는 리플렉션을 지원하지만, C++에서는 지원하고 있지 않다. 그래서 언리얼 자체 시스템으로 리플렉션을 제공하고 있으며 그 시스템을 언리얼의 리플렉션인 프로퍼티라 부른다.

- 리플렉션을 가질 수 있는 오브젝트로 열거형 UENUM(), 클래스 UCLASS(),구조체 USTRUCT(),함수 UFUNCTION(),멤버변수 UPROPERTY() 가 있다.
- 에디터의 디테일 패널, 시리얼라이제이션, 가비지 콜렉션, 네트워크 리플리케이션, 블루프린트/C++ 커뮤니케이션등 언리얼의 다양한 기능에서 사용된다.
- 리플렉션을 가지게 하려면 오브젝트가 포함된 C++ 클래스 헤더 파일에 `#include "FileName.generated.h"`를 추가해 줘야 한다. 해당 헤더를 가져야 리플렉션이 있는 시스템에서 해당 클래스가 존재하는지 알고 시스템 구현이 필요함을 언리얼 헤더 툴에 알린다.

소스 코드를 컴파일하기 전에 UHT(Unreal Header Tool)는 클래스 선언에서 리플렉션을 위한 매크로와 키워드를 분석한다. 이 과정에서 언리얼 실행 환경에 필요한 부가 정보를 생성하고, 이를 generated.h 파일에 포함한다. 해당 파일은 컴파일 과정에서 자동으로 생성되므로, 정상적으로 빌드되기 위해서는 코드 헤더 선언부의 마지막에 반드시 generated.h를 포함해야 한다.

### **`generated.h` 파일과 리플렉션**
- **Unreal Header Tool (UHT)** 는 컴파일 전에 클래스 선언을 분석하여, 리플렉션을 위한 부가 정보를 `generated.h` 파일에 생성함.
- `generated.h`가 포함된 상태로 소스 코드를 컴파일하면, 언리얼 엔진은 해당 정보를 이용해 **UObject를 관리하고, 에디터에서 편집할 수 있는 인터페이스를 제공**함.
- `UENUM()`, `UCLASS()`, `USTRUCT()`, `UFUNCTION()`, `UPROPERTY()` 등의 매크로를 사용하려면 반드시 `generated.h`를 포함해야 함.
- **`generated.h`가 포함된 클래스는 `UCLASS()` 및 `GENERATED_BODY()` 매크로를 반드시 포함해야 함.**

---

### **`UCLASS()` 매크로와 지정자**
- `UCLASS()` 매크로는 언리얼 엔진에서 해당 클래스를 `UObject` 기반 객체로 인식하게 함.
- `UCLASS()` 뒤의 괄호 `()` 안에는 **특정 기능을 추가하는 "지정자(Specifier)"** 를 삽입할 수 있음.
- 지정자는 클래스에 따라 다르며, 자주 사용되는 지정자는 다음과 같음.

#### **주요 `UCLASS()` 지정자**
| **지정자** | **설명** |
|------------|----------------------------|
| `Abstract` | 해당 클래스를 **추상 클래스**로 지정하여 **레벨에 배치할 수 없게 함.** |
| `Blueprintable` | 블루프린트에서 해당 클래스를 **확장 가능**하도록 허용. |
| `BlueprintType` | 블루프린트에서 **변수 타입으로 사용할 수 있도록 노출**. |

```cpp
UCLASS(Blueprintable, Abstract)
class MYGAME_API UMyObject : public UObject
{
    GENERATED_BODY()
};
```

### **`GENERATED_BODY()` 매크로**
- 언리얼 엔진의 리플렉션 시스템을 위해 필수적인 매크로.
- UObject 기반 클래스에 필요한 추가적인 함수 및 typedef(Super::, ThisClass:: 등)를 자동 생성함.
- 해당 클래스를 언리얼 시스템에서 관리할 수 있도록 함.

## 리플렉션(Reflection)이 있는 클래스 vs 없는 클래스

### 리플렉션이 있는 클래스
  - 언리얼 엔진의 **객체 시스템(UObject 기반)**을 사용하며, 에디터에서 관리 가능.
  - 에디터 UI에서 변수 값을 확인하거나 변경할 수 있음.
  - 레벨에 액터를 배치할 수 있으며, 멤버 변수를 에디터에서 관리할 수도 있음.
```cpp
UCLASS()
class MYGAME_API AMyActor : public AActor
{
    GENERATED_BODY()

public:
    UPROPERTY(VisibleAnywhere)
    int32 Health;  // 디테일 패널에서 확인 가능
};
```
### 리플렉션이 없는 클래스
- UCLASS() 매크로가 없기 때문에 언리얼 엔진의 UObject 시스템과 연결되지 않음.
- 에디터의 콘텐츠 브라우저에서 찾을 수 없음.
- UFUNCTION(), UPROPERTY() 등의 매크로를 사용할 수 없음.

```cpp
#pragma once

#include "CoreMinimal.h"

class UE5PRACTICE_API MyClass
{
public:
    MyClass();
    ~MyClass();
};
```

- 이 클래스는 언리얼 엔진이 관리하지 않으며, 에디터 UI에도 표시되지 않음.
- 즉, 일반적인 C++ 클래스와 동일하게 동작하며, 리플렉션 기능을 사용할 수 없음.
